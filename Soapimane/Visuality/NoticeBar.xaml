<Window x:Class="Visuality.NoticeBar"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Visuality"
        mc:Ignorable="d"
        Title="NoticeBarContainer"
        Height="450"
        Width="800"
        AllowsTransparency="True"
        WindowStyle="None"
        ShowInTaskbar="False"
        Background="{x:Null}"
        Foreground="{x:Null}"
        WindowState="Maximized"
        Topmost="True">

    <Window.Resources>
        <!-- Notice item template -->
        <DataTemplate x:Key="NoticeTemplate">
            <Grid Margin="0,0,0,12">
                <!-- Main notice card -->
                <Border MinHeight="48"
                        MinWidth="280"
                        MaxWidth="500"
                        CornerRadius="12"
                        BorderThickness="1"
                        BorderBrush="#3FFFFFFF"
                        Padding="0"
                        Cursor="Hand"
                        ToolTip="Click to copy"
                        MouseLeftButtonUp="NoticeItem_MouseLeftButtonUp">
                    <Border.Background>
                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                            <GradientStop Color="#FF101010" Offset="0"/>
                            <GradientStop Color="{Binding ThemeColorMid}" Offset="0.5"/>
                            <GradientStop Color="{Binding ThemeColorEnd}" Offset="1"/>
                        </LinearGradientBrush>
                    </Border.Background>

                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- Content area -->
                        <Grid Grid.Row="0" Margin="16,14,16,14">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <!-- Icon with colored background -->
                            <Border Grid.Column="0"
                                    Width="32"
                                    Height="32"
                                    CornerRadius="8"
                                    Background="{Binding IconBackground}"
                                    Margin="0,0,14,0"
                                    VerticalAlignment="Top">
                                <Path Fill="White"
                                      Data="{Binding IconData}"
                                      Stretch="Uniform"
                                      Width="16"
                                      Height="16"
                                      HorizontalAlignment="Center"
                                      VerticalAlignment="Center"/>
                            </Border>

                            <!-- Message content -->
                            <Grid Grid.Column="1" VerticalAlignment="Center">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <!-- Type label -->
                                <TextBlock Grid.Row="0"
                                           Text="{Binding TypeLabel}"
                                           Foreground="{Binding IconColor}"
                                           FontSize="11"
                                           FontWeight="SemiBold"
                                           FontFamily="Segoe UI"
                                           Margin="0,0,0,4"/>

                                <!-- Message text with scroll for long content -->
                                <ScrollViewer Grid.Row="1"
                                              MaxHeight="120"
                                              VerticalScrollBarVisibility="Auto"
                                              HorizontalScrollBarVisibility="Disabled">
                                    <TextBlock Text="{Binding Message}"
                                               Foreground="#DDFFFFFF"
                                               FontSize="13"
                                               FontFamily="Segoe UI"
                                               FontWeight="Normal"
                                               TextWrapping="Wrap"
                                               LineHeight="20"/>
                                </ScrollViewer>
                            </Grid>
                        </Grid>

                        <!-- Progress bar at bottom -->
                        <Border Grid.Row="1"
                                Height="3"
                                CornerRadius="0,0,12,12"
                                Background="#15FFFFFF"
                                ClipToBounds="True">
                            <Border x:Name="ProgressBar"
                                    HorizontalAlignment="Left"
                                    CornerRadius="0,0,0,12"
                                    Background="#99FFFFFF"/>
                        </Border>
                    </Grid>
                </Border>
            </Grid>
        </DataTemplate>

        <!-- Item container style -->
        <Style x:Key="NoticeItemStyle" TargetType="ListBoxItem">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ListBoxItem">
                        <ContentPresenter/>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Setter Property="Opacity" Value="0"/>
            <Style.Triggers>
                <EventTrigger RoutedEvent="Loaded">
                    <BeginStoryboard>
                        <Storyboard>
                            <DoubleAnimation Storyboard.TargetProperty="Opacity"
                                             From="0" To="1" Duration="0:0:0.2"/>
                        </Storyboard>
                    </BeginStoryboard>
                </EventTrigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>

    <Grid>
        <ListBox x:Name="NoticesContainer"
                  VerticalAlignment="Bottom"
                  HorizontalAlignment="Center"
                  Background="Transparent"
                  BorderThickness="0"
                  ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                  ScrollViewer.VerticalScrollBarVisibility="Disabled"
                  IsHitTestVisible="True"
                  ItemTemplate="{StaticResource NoticeTemplate}"
                  ItemContainerStyle="{StaticResource NoticeItemStyle}"
                  Margin="0,0,0,180">
            <ListBox.ItemsPanel>
                <ItemsPanelTemplate>
                    <StackPanel/>
                </ItemsPanelTemplate>
            </ListBox.ItemsPanel>
        </ListBox>
    </Grid>
</Window>
